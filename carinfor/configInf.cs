using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace carinfor
{
    public class equipmentConfigInfdata
    {

        private string cgjck;

        public string Cgjck
        {
            get { return cgjck; }
            set { cgjck = value; }
        }
        private string fqyck;

        public string Fqyck
        {
            get { return fqyck; }
            set { fqyck = value; }
        }
        private string lljck;

        public string Lljck
        {
            get { return lljck; }
            set { lljck = value; }
        }
        private string ydjck;

        public string Ydjck
        {
            get { return ydjck; }
            set { ydjck = value; }
        }
        private bool isOldMqy200;
        private string lzydjck;

        public string Lzydjck
        {
            get { return lzydjck; }
            set { lzydjck = value; }
        }
        private string ledck;

        public string Ledck
        {
            get { return ledck; }
            set { ledck = value; }
        }
        private string xce100ck;

        public string Xce100ck
        {
            get { return xce100ck; }
            set { xce100ck = value; }
        }
        private bool cgjifpz;

        public bool Cgjifpz
        {
            get { return cgjifpz; }
            set { cgjifpz = value; }
        }
        private bool fqyifpz;

        public bool Fqyifpz
        {
            get { return fqyifpz; }
            set { fqyifpz = value; }
        }
        private bool lljifpz;

        public bool Lljifpz
        {
            get { return lljifpz; }
            set { lljifpz = value; }
        }
        private bool ydjifpz;

        public bool Ydjifpz
        {
            get { return ydjifpz; }
            set { ydjifpz = value; }
        }
        private bool lzydjifpz;

        public bool Lzydjifpz
        {
            get { return lzydjifpz; }
            set { lzydjifpz = value; }
        }
        private bool ledifpz;

        public bool Ledifpz
        {
            get { return ledifpz; }
            set { ledifpz = value; }
        }
        private string cgjxh;

        public string Cgjxh
        {
            get { return cgjxh; }
            set { cgjxh = value; }
        }
        private string fqyxh;

        public string Fqyxh
        {
            get { return fqyxh; }
            set { fqyxh = value; }
        }
        private string lljxh;

        public string Lljxh
        {
            get { return lljxh; }
            set { lljxh = value; }
        }
        private string ydjxh;

        public string Ydjxh
        {
            get { return ydjxh; }
            set { ydjxh = value; }
        }
        private string lzydjxh;

        public string Lzydjxh
        {
            get { return lzydjxh; }
            set { lzydjxh = value; }
        }
        public string lzydjadd { set; get; }
        private string[] powerSet;

        public string[] PowerSet
        {
            get { return powerSet; }
            set { powerSet = value; }
        }
        public bool isTpTempInstrument { set; get; }
        private string tempInstrument;

        public string TempInstrument
        {
            get { return tempInstrument; }
            set { tempInstrument = value; }
        }
        private string bpqXh;

        public string BpqXh
        {
            get { return bpqXh; }
            set { bpqXh = value; }
        }
        private string bpqMethod;

        public string BpqMethod
        {
            get { return bpqMethod; }
            set { bpqMethod = value; }
        }
        private string bpqCom;

        public string BpqCom
        {
            get { return bpqCom; }
            set { bpqCom = value; }
        }
        private string bpqComPz;

        public string BpqComPz
        {
            get { return bpqComPz; }
            set { bpqComPz = value; }
        }
        private double bpqXs;

        public double BpqXs
        {
            get { return bpqXs; }
            set { bpqXs = value; }
        }

        private int bpqDy;

        public int BpqDy
        {
            get { return bpqDy; }
            set { bpqDy = value; }
        }
        private string testStandard;

        public string TestStandard
        {
            get { return testStandard; }
            set { testStandard = value; }
        }
        private int emergencyStop;

        public int EmergencyStop
        {
            get { return emergencyStop; }
            set { emergencyStop = value; }
        }
        private int heatFan;

        public int HeatFan
        {
            get { return heatFan; }
            set { heatFan = value; }
        }
        private string displayMethod;

        public string DisplayMethod
        {
            get { return displayMethod; }
            set { displayMethod = value; }
        }
        private int mainDislpay;

        public int MainDislpay
        {
            get { return mainDislpay; }
            set { mainDislpay = value; }
        }
        private int driverDisplay;

        public int DriverDisplay
        {
            get { return driverDisplay; }
            set { driverDisplay = value; }
        }
        public bool displayJudge { set; get; }
        public int CgjNz { set; get; }
        public int DriverFbl { set; get; }
        private string ledxh;

        public string Ledxh
        {
            get { return ledxh; }
            set { ledxh = value; }
        }
        private string ledComstring;

        public string LedComstring
        {
            get { return ledComstring; }
            set { ledComstring = value; }
        }
        private string xce100Comstring;

        public string Xce100Comstring
        {
            get { return xce100Comstring; }
            set { xce100Comstring = value; }
        }
        public string cgjckpzz { set; get; }
        private string fqyckpzz;

        public string Fqyckpzz
        {
            get { return fqyckpzz; }
            set { fqyckpzz = value; }
        }

        private string ydjckpzz;

        public string Ydjckpzz
        {
            get { return ydjckpzz; }
            set { ydjckpzz = value; }
        }
        private string lljckpzz;

        public string Lljckpzz
        {
            get { return lljckpzz; }
            set { lljckpzz = value; }
        }
        private string zsjckpzz;

        public string Zsjckpzz
        {
            get { return zsjckpzz; }
            set { zsjckpzz = value; }
        }
        private string lzckpzz;

        public string Lzckpzz
        {
            get { return lzckpzz; }
            set { lzckpzz = value; }
        }
        private int fqyDelayTime;

        public int FqyDelayTime
        {
            get { return fqyDelayTime; }
            set { fqyDelayTime = value; }
        }
        private int lljDelayTime;

        public int LljDelayTime
        {
            get { return lljDelayTime; }
            set { lljDelayTime = value; }
        }
        private double lljllmy;

        public double Lljllmy
        {
            get { return lljllmy; }
            set { lljllmy = value; }
        }
        private int lugdownWdsj;

        public int LugdownWdsj
        {
            get { return lugdownWdsj; }
            set { lugdownWdsj = value; }
        }

        public bool IsOldMqy200
        {
            get
            {
                return isOldMqy200;
            }

            set
            {
                isOldMqy200 = value;
            }
        }
        private bool workAutomaticMode;
        public bool WorkAutomaticMode
        {
            get
            {
                return workAutomaticMode;
            }

            set
            {
                workAutomaticMode = value;
            }
        }
        private string tmqxh;

        public string Tmqxh
        {
            get { return tmqxh; }
            set { tmqxh = value; }
        }
        private string tmqck;

        public string Tmqck
        {
            get { return tmqck; }
            set { tmqck = value; }
        }
        private string tmqckpz;

        public string Tmqckpz
        {
            get { return tmqckpz; }
            set { tmqckpz = value; }
        }


        public int BrakePWM
        {
            get
            {
                return brakePWM;
            }

            set
            {
                brakePWM = value;
            }
        }

        private int brakePWM;

        public int YdjL
        {
            get
            {
                return ydjL;
            }

            set
            {
                ydjL = value;
            }
        }
        private int ydjL;

        public bool isFdjzsJudge { set; get; }
        public bool isYhyPz { set; get; }
        public string YhyXh { set; get; }
        public string YhyCk { set; get; }
        public string YhjCkpz { set; get; }
        public int CarGdChanel { set; get; }
        public int ZzGdChanel { set; get; }
        public int LeftZzChanel { set; get; }
        public int RightZzChanel { set; get; }
        public double LeftZzXs { set; get; }
        public double RightZxXs { set; get; }
        public UInt16 LeftZzZero { set; get; }
        public UInt16 RightZxZero { set; get; }
        public bool isIgbtContainGdyk { set; get; }
        public bool isYdjNhSelfUse { set; get; }
        public bool isFqyNhSelfUse { set; get; }
        public bool isLljNhSelfUse { set; get; }
        public int ledrow1 { set; get; }
        public int ledrow2 { set; get; }
        public int LEDTJPH { set; get; }
        public bool ZzyEnable { set; get; }
        public string ZzyXh { set; get; }
        public string ZzyCk { set; get; }
        public string ZzyCkpzz { set; get; }
        public int ZzSureStyle { set; get; }
        public string WeightWCFaddress { set; get; }
        public bool useWeightWCF { set; get; }

        public bool NOxifpz { set; get; }
        public string NOxXh { set; get; }
        public string NOxCk { set; get; }
        public string NOxCkpz { set; get; }
        public bool useJHJK { set; get; }
        public bool useJHSCREEN { set; get; }
        public double JHLBGLB { set; get; }
        public double JHLAMBDAMIN { set; get; }
        public double JHLAMBDAMAX { set; get; }
        public string DATASECONDS_TYPE { set; get; }
        public bool cd_fqy { set; get; }
        public bool cd_ydj { set; get; }
        public bool IsUseNhSjz { set; get; }
        public string NhSjz_Com { set; get; }
        public string NhSjz_ComString { set; get; }
    }
    public class thaxs
    {
        private double tempxs;

        public double Tempxs
        {
            get { return tempxs; }
            set { tempxs = value; }
        }
        private double humixs;

        public double Humixs
        {
            get { return humixs; }
            set { humixs = value; }
        }
        private double airpxs;

        public double Airpxs
        {
            get { return airpxs; }
            set { airpxs = value; }
        }
    }
    public class VmasConfigInfdata
    {
        private bool autoRestart;

        public bool AutoRestart
        {
            get { return autoRestart; }
            set { autoRestart = value; }
        }
        private bool test;

        public bool Test
        {
            get { return test; }
            set { test = value; }
        }
        private bool speedMonitor;

        public bool SpeedMonitor
        {
            get { return speedMonitor; }
            set { speedMonitor = value; }
        }
        private bool powerMonitor;

        public bool PowerMonitor
        {
            get { return powerMonitor; }
            set { powerMonitor = value; }
        }
        private bool concentrationMonitor;

        public bool ConcentrationMonitor
        {
            get { return concentrationMonitor; }
            set { concentrationMonitor = value; }
        }
        public bool SdCo2AndO2Monitor { set; get; }
        private bool flowMonitorr;

        public bool FlowMonitorr
        {
            get { return flowMonitorr; }
            set { flowMonitorr = value; }
        }
        private bool thinnerratioMonitor;

        public bool ThinnerratioMonitor
        {
            get { return thinnerratioMonitor; }
            set { thinnerratioMonitor = value; }
        }
        private bool huanjingo2Monitor;

        public bool Huanjingo2Monitor
        {
            get { return huanjingo2Monitor; }
            set { huanjingo2Monitor = value; }
        }
        private bool remainedMonitor;

        public bool RemainedMonitor
        {
            get { return remainedMonitor; }
            set { remainedMonitor = value; }
        }



        private bool ifFqyTl;

        public bool IfFqyTl
        {
            get { return ifFqyTl; }
            set { ifFqyTl = value; }
        }

        private bool flowback;

        public bool Flowback
        {
            get { return flowback; }
            set { flowback = value; }
        }

        private bool ifSureTemp;

        public bool IfSureTemp
        {
            get { return ifSureTemp; }
            set { ifSureTemp = value; }
        }
        private bool ifDisplayData;

        public bool IfDisplayData
        {
            get { return ifDisplayData; }
            set { ifDisplayData = value; }
        }
        private float ndz;

        public float Ndz
        {
            get { return ndz; }
            set { ndz = value; }
        }
        private float lljll;

        public float Lljll
        {
            get { return lljll; }
            set { lljll = value; }
        }
        private float wqll;

        public float Wqll
        {
            get { return wqll; }
            set { wqll = value; }
        }
        private float xsb;

        public float Xsb
        {
            get { return xsb; }
            set { xsb = value; }
        }
        private float gljz;

        public float Gljz
        {
            get { return gljz; }
            set { gljz = value; }
        }

        private float lxcc;


        public float Lxcc
        {
            get { return lxcc; }
            set { lxcc = value; }
        }
        private float ljcc;

        public float Ljcc
        {
            get { return ljcc; }
            set { ljcc = value; }
        }

        private int dssj;

        public int Dssj
        {
            get { return dssj; }
            set { dssj = value; }
        }


        private int flowTime;


        public int FlowTime
        {
            get { return flowTime; }
            set { flowTime = value; }
        }

        private float ccTimeXs;

        public float CcTimeXs
        {
            get { return ccTimeXs; }
            set { ccTimeXs = value; }
        }

        private bool isTestYw;

        public bool IsTestYw
        {
            get { return isTestYw; }
            set { isTestYw = value; }
        }


        private bool isWholeProcessJK;
        public bool IsWholeProcessJK
        {
            get
            {
                return isWholeProcessJK;
            }

            set
            {
                isWholeProcessJK = value;
            }
        }
        public int ndccsj { set; get; }
        public bool CjBeforeTl { set; get; }
        public float vmasPowerXs { set; get; }
        public bool vmasNoReZero { set; get; }
    }
    public class AsmConfigInfdata
    {
        private bool speedMonitor;

        public bool SpeedMonitor
        {
            get { return speedMonitor; }
            set { speedMonitor = value; }
        }
        private bool speed05Monitor;
        private bool powerMonitor;

        public bool PowerMonitor
        {
            get { return powerMonitor; }
            set { powerMonitor = value; }
        }
        private bool concentrationMonitor;

        public bool ConcentrationMonitor
        {
            get { return concentrationMonitor; }
            set { concentrationMonitor = value; }
        }
        private bool remainedMonitor;

        public bool RemainedMonitor
        {
            get { return remainedMonitor; }
            set { remainedMonitor = value; }
        }



        private bool ifFqyTl;

        public bool IfFqyTl
        {
            get { return ifFqyTl; }
            set { ifFqyTl = value; }
        }

        private bool flowback;

        public bool Flowback
        {
            get { return flowback; }
            set { flowback = value; }
        }

        private bool ifSureTemp;

        public bool IfSureTemp
        {
            get { return ifSureTemp; }
            set { ifSureTemp = value; }
        }
        private bool ifDisplayData;

        public bool IfDisplayData
        {
            get { return ifDisplayData; }
            set { ifDisplayData = value; }
        }
        private float ndz;

        public float Ndz
        {
            get { return ndz; }
            set { ndz = value; }
        }

        private float gljz;

        public float Gljz
        {
            get { return gljz; }
            set { gljz = value; }
        }
        private float glcs;

        public float Glcs
        {
            get { return glcs; }
            set { glcs = value; }
        }
        private float lxcc;


        public float Lxcc
        {
            get { return lxcc; }
            set { lxcc = value; }
        }

        private int flowTime;


        public int FlowTime
        {
            get { return flowTime; }
            set { flowTime = value; }
        }

        private bool isTestYw;

        public bool IsTestYw
        {
            get { return isTestYw; }
            set { isTestYw = value; }
        }
        private bool isKsgkUsed;

        public bool IsKsgkUsed
        {
            get { return isKsgkUsed; }
            set { isKsgkUsed = value; }
        }
        public bool IsFixCo2 { set; get; }

        public bool Speed05Monitor
        {
            get
            {
                return speed05Monitor;
            }

            set
            {
                speed05Monitor = value;
            }
        }
        public bool IsAsmHalfXzKsgk { set; get; }
        public string Ywj { set; get; }
        public bool asmNoReZero { set; get; }
    }
    public class SdsConfigInfdata
    {
        private bool rotateSpeedMonitor;

        public bool RotateSpeedMonitor
        {
            get { return rotateSpeedMonitor; }
            set { rotateSpeedMonitor = value; }
        }

        private bool concentrationMonitor;

        public bool ConcentrationMonitor
        {
            get { return concentrationMonitor; }
            set { concentrationMonitor = value; }
        }

        private bool ifFqyTl;

        public bool IfFqyTl
        {
            get { return ifFqyTl; }
            set { ifFqyTl = value; }
        }

        private bool flowback;

        public bool Flowback
        {
            get { return flowback; }
            set { flowback = value; }
        }


        private float ndz;

        public float Ndz
        {
            get { return ndz; }
            set { ndz = value; }
        }

        private int zscc;

        public int Zscc
        {
            get { return zscc; }
            set { zscc = value; }
        }

        private int flowTime;


        public int FlowTime
        {
            get { return flowTime; }
            set { flowTime = value; }
        }

        private string zsj;

        public string Zsj
        {
            get { return zsj; }
            set { zsj = value; }
        }

        private string zsjck;

        public string Zsjck
        {
            get { return zsjck; }
            set { zsjck = value; }
        }

        private bool isTestYw;

        public bool IsTestYw
        {
            get { return isTestYw; }
            set { isTestYw = value; }
        }
        public int TimerMode3500 { set; get; }
        public int TimerModeHP { set; get; }
        public int TimerModeHT { set; get; }
        public int TimerModeLP { set; get; }
        public int TimerModeLT { set; get; }
        public bool IsSureTemp { set; get; }
        public string Ywj { set; get; }
        public bool sdsNoReZero { set; get; }
        public bool sdsHighLambdaMonitor { set; get; }
        public bool sdsLowLambdaMonitor { set; get; }
    }
    public class BtgConfigInfdata
    {
        private bool rotateSpeedMonitor;

        public bool RotateSpeedMonitor
        {
            get { return rotateSpeedMonitor; }
            set { rotateSpeedMonitor = value; }
        }
        public bool jhzsgcjk { set; get; }

        private int dyzs;

        public int Dyzs
        {
            get { return dyzs; }
            set { dyzs = value; }
        }

        private string zsj;

        public string Zsj
        {
            get { return zsj; }
            set { zsj = value; }
        }

        private string zsjck;

        public string Zsjck
        {
            get { return zsjck; }
            set { zsjck = value; }
        }

        private bool isTestYw;

        public bool IsTestYw
        {
            get { return isTestYw; }
            set { isTestYw = value; }
        }

        private int btgcfcs;

        public int Btgcfcs
        {
            get { return btgcfcs; }
            set { btgcfcs = value; }
        }
        public int btgclcs { set; get; }
        public bool BtgManualTantou
        {
            get
            {
                return btgManualTantou;
            }

            set
            {
                btgManualTantou = value;
            }
        }

        private bool btgManualTantou;
        /// <summary>
        /// 0:取怠速转速 1：取断油转速
        /// </summary>
        public int btgDszsValue { set; get; }
        public string Ywj { set; get; }
        public bool isYdjk { set; get; }
        public double ydjk_value { set; get; }

    }
    public class DynConfigInfdata
    {
        
        private string zsj;

        public string Zsj
        {
            get { return zsj; }
            set { zsj = value; }
        }

        private string zsjck;

        public string Zsjck
        {
            get { return zsjck; }
            set { zsjck = value; }
        }
        public int cczs { set; get; }
        public int stableTime { set; get; }
        /// <summary>
        /// 加载力上升频率
        /// </summary>
        public int forceTime { set; get; }
        /// <summary>
        /// 油耗测试加载力上升频率
        /// </summary>
        public int FuelforceTime { set; get; }
        public float FuelSdQj { set; get; }
        public float FuelForceQj { set; get; }
        public float DynSdqj { set; get; }
        public float DynVwSdqj { set; get; }
        public float DynForceQj { set; get; }
        public int DynMaxWaitTime { set; get; }
        /// <summary>
        /// 遥控方式 0-自带遥控 1-外接遥控
        /// </summary>
        public int DynYkStyle { set; get; }
        /// <summary>
        /// 0-重新测量60s 1-重新测量15s
        /// </summary>
        public int DynReStartStyle { set; get; }
        /// <summary>
        /// 外接遥控通道
        /// </summary>
        public int DynWjyktd { set; get; }
        public int DynGddwTime { set; get; }
        public bool DynUseGddw { set; get; }
        public bool DynUseYkdw { set; get; }
        public double DynFuelXz{ set; get; }
        public bool DynFuelJk { set; get; }
        public int FuelTestFjjs { set; get; }
        public string DynYkKey { set; get; }
        /// <summary>
        /// 文件格式0:Json 1:ini
        /// </summary>
        public int DynFileStyle { set; get; }
        public bool DynStopUnstable { set; get; }
        public int DynUnstableTime { set; get; }
        public double DynSdxs { set; get; }
        public double DynNlxs { set; get; }
        public bool DynTl { set; get; }
        public bool DynBackTest { set; get; }
        public bool DynCO2Test { set; get; }
        public bool DynFlowBack { set; get; }
        public bool DynYkqr { set; get; }
        public bool DynUseManualKey { set; get; }

    }
    public class LugdownConfigInfdata
    {
        private float minSpeed;

        public float MinSpeed
        {
            get { return minSpeed; }
            set { minSpeed = value; }
        }
        private bool ifSureTemp;

        public bool IfSureTemp
        {
            get { return ifSureTemp; }
            set { ifSureTemp = value; }
        }
        public bool isFdjzsJudge { set; get; }
        private float maxSpeed;

        public float MaxSpeed
        {
            get { return maxSpeed; }
            set { maxSpeed = value; }
        }

        private string zsj;

        public string Zsj
        {
            get { return zsj; }
            set { zsj = value; }
        }

        private string zsjck;

        public string Zsjck
        {
            get { return zsjck; }
            set { zsjck = value; }
        }

        private string glsmms;

        public string Glsmms
        {
            get { return glsmms; }
            set { glsmms = value; }
        }
        private float smpl;

        public float Smpl
        {
            get { return smpl; }
            set { smpl = value; }
        }
        private float sdwdqj;

        public float Sdwdqj
        {
            get { return sdwdqj; }
            set { sdwdqj = value; }
        }

        private bool isTestYw;

        public bool IsTestYw
        {
            get { return isTestYw; }
            set { isTestYw = value; }
        }
        /// <summary>
        /// 轮边功率取值点,0-在功率扫描阶段取 1-在100%velmaxhp点取
        /// </summary>
        public int LugdownMaxHpStyle
        {
            set;
            get;
        }
        public bool LugdownGljk { set; get; }
        public float Lugdown_Gljk_value { set; get; }
        public bool gsMaxPPD { set; get; }
        public bool gsKcbPD { set; get; }
        public bool gsKhgPD { set; get; }
        public bool testNOx { set; get; }
        public string Ywj { set; get; }
        public bool isYdjk_glsm { set; get; }
        public double ydjk_glsm_value { set; get; }
        public bool isYdjk_cl { set; get; }
        public double ydjk_cl_value { set; get; }
    }
    public class selfCheckItem
    {
        private bool jzjs;

        public bool Jzjs
        {
            get { return jzjs; }
            set { jzjs = value; }
        }
        private bool Jzhx;

        public bool Jzhx1
        {
            get { return Jzhx; }
            set { Jzhx = value; }
        }
        private bool Fqy;

        public bool Fqy1
        {
            get { return Fqy; }
            set { Fqy = value; }
        }
        private bool SdsFqy;

        public bool SdsFqy1
        {
            get { return SdsFqy; }
            set { SdsFqy = value; }
        }
        private bool Ydj;

        public bool Ydj1
        {
            get { return Ydj; }
            set { Ydj = value; }
        }

    }
    public class selfCheckData
    {
        private bool Jzhx;

        public bool Jzhx1
        {
            get { return Jzhx; }
            set { Jzhx = value; }
        }
        private bool Fqy;

        public bool Fqy1
        {
            get { return Fqy; }
            set { Fqy = value; }
        }
        private bool SdsFqy;

        public bool SdsFqy1
        {
            get { return SdsFqy; }
            set { SdsFqy = value; }
        }
        private bool Ydj;

        public bool Ydj1
        {
            get { return Ydj; }
            set { Ydj = value; }
        }
    }


    public class parasiticData
    {
        private float rc48;
        public float RC48
        {
            get { return rc48; }
            set { rc48 = value; }
        }
        private float rc40;
        public float RC40
        {
            get { return rc40; }
            set { rc40 = value; }
        }
        private float rc32;
        public float RC32
        {
            get { return rc32; }
            set { rc32 = value; }
        }
        private float rc24;
        public float RC24
        {
            get { return rc24; }
            set { rc24 = value; }
        }

        private float hz88;
        public float HZ88
        {
            get { return hz88; }
            set { hz88 = value; }
        }
        private float hz80;
        public float HZ80
        {
            get { return hz80; }
            set { hz80 = value; }
        }
        private float hz72;
        public float HZ72
        {
            get { return hz72; }
            set { hz72 = value; }
        }
        private float hz64;
        public float HZ64
        {
            get { return hz64; }
            set { hz64 = value; }
        }
        private float hz56;
        public float HZ56
        {
            get { return hz56; }
            set { hz56 = value; }
        }
        private float hz48;
        public float HZ48
        {
            get { return hz48; }
            set { hz48 = value; }
        }
        private float hz40;
        public float HZ40
        {
            get { return hz40; }
            set { hz40 = value; }
        }
        private float hz32;
        public float HZ32
        {
            get { return hz32; }
            set { hz32 = value; }
        }
        private float hz24;
        public float HZ24
        {
            get { return hz24; }
            set { hz24 = value; }
        }
        private float hz16;
        public float HZ16
        {
            get { return hz16; }
            set { hz16 = value; }
        }
        private string fs;
        public string FS
        {
            get { return fs; }
            set { fs = value; }
        }
        private float diw;
        public float DIW
        {
            get { return diw; }
            set { diw = value; }
        }
        private float jzhxgl;
        public float JZHXGL
        {
            get { return jzhxgl; }
            set { jzhxgl = value; }
        }
    }
    public class configIni
    {
        public string startUpPath = AppDomain.CurrentDomain.BaseDirectory;
        public parasiticData getParasiticIni()
        {
            float a = 0;
            int b = 0;
            parasiticData configinidata = new parasiticData();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("DIW", "DIW", "907", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.DIW = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("加载滑行", "功率", "6", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.JZHXGL = float.Parse(temp.ToString());

            ini.INIIO.GetPrivateProfileString("寄生功率(日常测试)", "48Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.RC48 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(日常测试)", "40Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.RC40 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(日常测试)", "32Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.RC32 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(日常测试)", "24Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.RC24 = float.Parse(temp.ToString());

            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "88Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ88 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "80Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ80 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "72Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ72 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "64Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ64 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "56Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ56 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "48Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ48 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "40Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ40 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "32Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ32 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "24Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ24 = float.Parse(temp.ToString());
            ini.INIIO.GetPrivateProfileString("寄生功率(核准)", "16Km/h", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.HZ16 = float.Parse(temp.ToString());


            ini.INIIO.GetPrivateProfileString("寄生功率方式", "方式", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.FS = temp.ToString();
            return configinidata;
        }
        public double getCgjNz(string v0)
        {
            double a = 0;
           
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("测功机内阻", v0, "0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (double.TryParse(temp.ToString(), out a))
            {
                return a;
            }
            else
                return 0;
        }

        public selfCheckData getSelfCheckDataIni()
        {
            float a = 0;
            int b = 0;
            selfCheckData configinidata = new selfCheckData();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;

            ini.INIIO.GetPrivateProfileString("设备自检", "加载滑行", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Jzhx1 = true;
            else
                configinidata.Jzhx1 = false;
            ini.INIIO.GetPrivateProfileString("设备自检", "废气仪", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Fqy1 = true;
            else
                configinidata.Fqy1 = false;
            ini.INIIO.GetPrivateProfileString("设备自检", "双怠速废气仪", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.SdsFqy1 = true;
            else
                configinidata.SdsFqy1 = false;
            ini.INIIO.GetPrivateProfileString("设备自检", "烟度计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Ydj1 = true;
            else
                configinidata.Ydj1 = false;

            return configinidata;
        }
        public selfCheckItem getSelfCheckItemIni()
        {
            float a = 0;
            int b = 0;
            selfCheckItem configinidata = new selfCheckItem();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("自检项目", "柴油车", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Jzjs = true;
            else
                configinidata.Jzjs = false;
            ini.INIIO.GetPrivateProfileString("自检项目", "加载滑行", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Jzhx1 = true;
            else
                configinidata.Jzhx1 = false;
            ini.INIIO.GetPrivateProfileString("自检项目", "废气仪", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Fqy1 = true;
            else
                configinidata.Fqy1 = false;
            ini.INIIO.GetPrivateProfileString("自检项目", "双怠速废气仪", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.SdsFqy1 = true;
            else
                configinidata.SdsFqy1 = false;
            ini.INIIO.GetPrivateProfileString("自检项目", "烟度计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.Ydj1 = true;
            else
                configinidata.Ydj1 = false;

            return configinidata;
        }
        public bool writeSelfConfigIni(selfCheckItem configinidata)
        {
            try
            {
                ini.INIIO.WritePrivateProfileString("自检项目", "柴油车", configinidata.Jzjs ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "加载滑行", configinidata.Jzhx1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "废气仪", configinidata.Fqy1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "双怠速废气仪", configinidata.SdsFqy1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "烟度计", configinidata.Ydj1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
        public bool writeSelfConfigIni(selfCheckData configinidata)
        {
            try
            {
                ini.INIIO.WritePrivateProfileString("自检项目", "加载滑行", configinidata.Jzhx1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "废气仪", configinidata.Fqy1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "双怠速废气仪", configinidata.SdsFqy1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("自检项目", "烟度计", configinidata.Ydj1 ? "Y" : "N", startUpPath+"/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
        public equipmentConfigInfdata getEquipConfigIni()
        {
            float a = 0;
            int b = 0;
            double c = 0;
            equipmentConfigInfdata configinidata = new equipmentConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;

            ini.INIIO.GetPrivateProfileString("配置参数", "测功机串口", "/", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Cgjck = temp.ToString().Trim().Split('/')[0];
            configinidata.Cgjxh = temp.ToString().Trim().Split('/')[1];
            ini.INIIO.GetPrivateProfileString("配置参数", "废气仪串口", "/", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Fqyck = temp.ToString().Trim().Split('/')[0];
            configinidata.Fqyxh = temp.ToString().Trim().Split('/')[1];
            ini.INIIO.GetPrivateProfileString("配置参数", "流量计串口", "/", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Lljck = temp.ToString().Trim().Split('/')[0];
            configinidata.Lljxh = temp.ToString().Trim().Split('/')[1];
            ini.INIIO.GetPrivateProfileString("配置参数", "油耗仪串口", "/", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.YhyCk = temp.ToString().Trim().Split('/')[0];
            configinidata.YhyXh = temp.ToString().Trim().Split('/')[1];
            ini.INIIO.GetPrivateProfileString("配置参数", "烟度计串口", "/", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Ydjck = temp.ToString().Trim().Split('/')[0];
            configinidata.Ydjxh = temp.ToString().Trim().Split('/')[1];
            ini.INIIO.GetPrivateProfileString("配置参数", "柴油车NOx串口", "/", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.NOxCk = temp.ToString().Trim().Split('/')[0];
            configinidata.NOxXh = temp.ToString().Trim().Split('/')[1];

            ini.INIIO.GetPrivateProfileString("配置参数", "是否鸣泉老烟度计", "N", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.IsOldMqy200 = true;
            else
                configinidata.IsOldMqy200 = false;

            ini.INIIO.GetPrivateProfileString("配置参数", "滤纸烟度计串口", "/", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Lzydjck = temp.ToString().Trim().Split('/')[0];
            configinidata.Lzydjxh = temp.ToString().Trim().Split('/')[1];
            ini.INIIO.GetPrivateProfileString("配置参数", "LED串口", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Ledck = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("配置参数", "XCE100串口", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Xce100ck = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("配置参数", "LED型号", "仰邦", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Ledxh = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("配置参数", "LED串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.LedComstring = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("配置参数", "XCE100串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Xce100Comstring= temp.ToString().Trim();

            ini.INIIO.GetPrivateProfileString("配置参数", "条码枪型号", "无", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Tmqxh = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("配置参数", "条码枪串口", "COM1", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Tmqck = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("配置参数", "条码枪串口配置", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Tmqckpz = temp.ToString().Trim();

            ini.INIIO.GetPrivateProfileString("配置参数", "测功机", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Cgjifpz = true;
            else
                configinidata.Cgjifpz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "废气仪", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Fqyifpz = true;
            else
                configinidata.Fqyifpz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "流量计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Lljifpz = true;
            else
                configinidata.Lljifpz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "油耗仪", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.isYhyPz = true;
            else
                configinidata.isYhyPz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "烟度计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Ydjifpz = true;
            else
                configinidata.Ydjifpz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "柴油车NOx", "", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.NOxifpz = true;
            else
                configinidata.NOxifpz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "滤纸烟度计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Lzydjifpz = true;
            else
                configinidata.Lzydjifpz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "LED屏", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Ledifpz = true;
            else
                configinidata.Ledifpz = false;

            ini.INIIO.GetPrivateProfileString("配置参数", "滤纸烟度计地址", "01", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.lzydjadd = temp.ToString().Trim();
            ini.INIIO.GetPrivateProfileString("吸收功率", "功率", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.PowerSet = temp.ToString().Trim().Split(',');

            ini.INIIO.GetPrivateProfileString("配置参数", "温湿度计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.TempInstrument = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "统配温湿度计", "N", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isTpTempInstrument= true;
            else
                configinidata.isTpTempInstrument = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "变频器控制方式", "端子", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.BpqMethod = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "变频器系数", "0.83", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.BpqXs = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.BpqXs = 0.83;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "变频器电源", "1", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.BpqDy = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.BpqDy = 1;
            }
            string bqpComInf;
            ini.INIIO.GetPrivateProfileString("配置参数", "变频器串口配置", "COM5/9600,N,8,1/AMB", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            bqpComInf = temp.ToString();
            configinidata.BpqCom = bqpComInf.Split('/')[0];
            configinidata.BpqComPz = bqpComInf.Split('/')[1];
            configinidata.BpqXh = bqpComInf.Split('/')[2];
            ini.INIIO.GetPrivateProfileString("配置参数", "测试标准", "HJT290", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.TestStandard = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "散热风扇", "2", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.HeatFan = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.HeatFan = 2;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "紧急停止", "1", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.EmergencyStop = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.EmergencyStop = 1;
            }

            ini.INIIO.GetPrivateProfileString("配置参数", "显示方式", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.DisplayMethod = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "主显示", "0", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.MainDislpay = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.MainDislpay = 0;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "司机助", "1", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DriverDisplay = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DriverDisplay = 1;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "司机助分辨率", "0", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DriverFbl = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DriverFbl = 0;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "测功机串口配置字", "38400,N,8,1", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString() == "") configinidata.cgjckpzz = "38400,N,8,1";
            else
                configinidata.cgjckpzz = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "废气仪串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString() == "") configinidata.Fqyckpzz = "9600,N,8,1";
            else
                configinidata.Fqyckpzz = temp.ToString();

            ini.INIIO.GetPrivateProfileString("配置参数", "烟度计串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString() == "") configinidata.Ydjckpzz = "9600,N,8,1";
            else
                configinidata.Ydjckpzz = temp.ToString();

            ini.INIIO.GetPrivateProfileString("配置参数", "流量计串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString() == "") configinidata.Lljckpzz = "9600,N,8,1";
            else
                configinidata.Lljckpzz = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "油耗仪串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString() == "") configinidata.YhjCkpz = "9600,N,8,1";
            else
                configinidata.YhjCkpz = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "转速计串口配置字", "9600,N,8,1", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString() == "") configinidata.Zsjckpzz = "9600,N,8,1";
            else
                configinidata.Zsjckpzz = temp.ToString();

            ini.INIIO.GetPrivateProfileString("配置参数", "柴油车NOx串口配置字", "9600,N,8,1", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString() == "") configinidata.NOxCkpz = "9600,N,8,1";
            else
                configinidata.NOxCkpz = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "滤纸串口配置字", "300,N,8,2", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString() == "") configinidata.Lzckpzz = "300,N,8,2";
            else
                configinidata.Lzckpzz = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "废气仪响应时间", "6", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.FqyDelayTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.FqyDelayTime = 6;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "流量计响应时间", "1", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.LljDelayTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.LljDelayTime = 1;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "流量计流量名义值", "160.0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.Lljllmy = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.Lljllmy = 160;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "加载减速稳定时间", "3", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.LugdownWdsj = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.LugdownWdsj = 3;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "全自动工作模式", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.WorkAutomaticMode = true;
            else
                configinidata.WorkAutomaticMode = false;


            ini.INIIO.GetPrivateProfileString("配置参数", "烟度计光通道有效长度", "215", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.YdjL = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.YdjL = 215;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "刹车占空比", "15", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.BrakePWM = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.BrakePWM = 15;
            }

            ini.INIIO.GetPrivateProfileString("配置参数", "是否评价发动机转速", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.isFdjzsJudge = true;
            else
                configinidata.isFdjzsJudge = false;

            ini.INIIO.GetPrivateProfileString("配置参数", "到位光电", "1", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.CarGdChanel = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.CarGdChanel = 1;
            }

            ini.INIIO.GetPrivateProfileString("配置参数", "是否包含光电遥控", "N", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isIgbtContainGdyk = true;
            else
                configinidata.isIgbtContainGdyk = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "是否南华自用废气仪", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isFqyNhSelfUse = true;
            else
                configinidata.isFqyNhSelfUse = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "是否南华自用烟度计", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isYdjNhSelfUse = true;
            else
                configinidata.isYdjNhSelfUse = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "是否南华自用流量计", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isLljNhSelfUse = true;
            else
                configinidata.isLljNhSelfUse = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "显示评价结果", "Y", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.displayJudge = true;
            else
                configinidata.displayJudge = false;

            ini.INIIO.GetPrivateProfileString("配置参数", "LEDROW1", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ledrow1 = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ledrow1 = 0;
            }

            ini.INIIO.GetPrivateProfileString("配置参数", "LEDROW2", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ledrow2 = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ledrow2 = 2;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "LEDTJPH", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.LEDTJPH = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.LEDTJPH = 2;
            }

            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重仪", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.ZzyEnable = temp.ToString() == "Y";
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重仪型号", "未配置", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.ZzyXh = temp.ToString();
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重仪串口", "COM1", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.ZzyCk = temp.ToString();
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重仪串口配置", "38400,N,8,1", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString() == "") configinidata.ZzyCkpzz = "38400,N,8,1";
            else
                configinidata.ZzyCkpzz = temp.ToString();
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重确认方式", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ZzSureStyle = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ZzSureStyle = 0;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重光电通道", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ZzGdChanel = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ZzGdChanel = 1;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重左通道", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.LeftZzChanel = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.LeftZzChanel = 1;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重右通道", "2", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.RightZzChanel = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.RightZzChanel = 2;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重左系数", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.LeftZzXs = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.LeftZzXs = 1;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重右系数", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.RightZxXs = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.RightZxXs = 1;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重左零点", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.LeftZzZero = UInt16.Parse(temp.ToString());
            }
            catch
            {
                configinidata.LeftZzZero = 1;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "轴重右零点", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.RightZxZero = UInt16.Parse(temp.ToString());
            }
            catch
            {
                configinidata.RightZxZero = 0;
            }
            ini.INIIO.GetPrivateProfileString("轴重仪", "使用称重WCF", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.useWeightWCF = true;
            else
                configinidata.useWeightWCF = false;
            ini.INIIO.GetPrivateProfileString("轴重仪", "称重WCF地址", "http://192.168.0.123:8733/Design_Time_Addresses/LZ_TEST/LZService/mex", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.WeightWCFaddress = temp.ToString().Trim();

            ini.INIIO.GetPrivateProfileString("配置参数", "使用金华监控选项", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.useJHJK = true;
            else
                configinidata.useJHJK = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "金华屏蔽显示", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.useJHSCREEN = true;
            else
                configinidata.useJHSCREEN = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "金华轮边功率预警值", "80", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.JHLBGLB = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.JHLBGLB = 80;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "金华过量空气系数最小值", "0.9", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.JHLAMBDAMIN = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.JHLAMBDAMIN = 0.9;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "金华过量空气系数最大值", "1.1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.JHLAMBDAMAX = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.JHLAMBDAMAX = 1.1;
            }
            ini.INIIO.GetPrivateProfileString("配置参数", "过程数据", "常规", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString() == "") configinidata.DATASECONDS_TYPE = "常规";
            else
                configinidata.DATASECONDS_TYPE = temp.ToString();

            ini.INIIO.GetPrivateProfileString("配置参数", "驰达废气仪", "Y", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.cd_fqy = true;
            else
                configinidata.cd_fqy = false;

            ini.INIIO.GetPrivateProfileString("配置参数", "驰达烟度计", "Y", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.cd_ydj = true;
            else
                configinidata.cd_ydj = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "南华司机助", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.IsUseNhSjz = true;
            else
                configinidata.IsUseNhSjz = false;
            ini.INIIO.GetPrivateProfileString("配置参数", "南华司机助串口", "COM1", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.NhSjz_Com = temp.ToString();
            ini.INIIO.GetPrivateProfileString("配置参数", "南华司机助串口配置", "9600,N,8,1", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.NhSjz_ComString = temp.ToString();
            return configinidata;
        }
        public bool writeEquipmentConfig(equipmentConfigInfdata equipconfig)
        {
            try
            {
                ini.INIIO.WritePrivateProfileString("配置参数", "测功机串口", equipconfig.Cgjck + "/" + equipconfig.Cgjxh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "滤纸烟度计串口", equipconfig.Lzydjck + "/" + equipconfig.Lzydjxh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "废气仪串口", equipconfig.Fqyck + "/" + equipconfig.Fqyxh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "流量计串口", equipconfig.Lljck + "/" + equipconfig.Lljxh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "油耗仪串口", equipconfig.YhyCk + "/" + equipconfig.YhyXh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "烟度计串口", equipconfig.Ydjck + "/" + equipconfig.Ydjxh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "柴油车NOx串口", equipconfig.NOxCk + "/" + equipconfig.NOxXh, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "是否鸣泉老烟度计", equipconfig.IsOldMqy200?"Y":"N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "是否南华自用废气仪", equipconfig.isFqyNhSelfUse ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "是否南华自用烟度计", equipconfig.isYdjNhSelfUse ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "是否南华自用流量计", equipconfig.isLljNhSelfUse ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "烟度计光通道有效长度", equipconfig.YdjL.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "刹车占空比", equipconfig.BrakePWM.ToString(), startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("配置参数", "条码枪型号", equipconfig.Tmqxh, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "条码枪串口", equipconfig.Tmqck, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "条码枪串口配置", equipconfig.Tmqckpz, startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("配置参数", "测功机串口配置字", equipconfig.cgjckpzz, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "废气仪串口配置字", equipconfig.Fqyckpzz, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "烟度计串口配置字", equipconfig.Ydjckpzz, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "流量计串口配置字", equipconfig.Lljckpzz, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "油耗仪串口配置字", equipconfig.YhjCkpz, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "转速计串口配置字", equipconfig.Zsjckpzz, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "柴油车NOx串口配置字", equipconfig.NOxCkpz, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "滤纸串口配置字", equipconfig.Lzckpzz, startUpPath + "/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("配置参数", "LED串口", equipconfig.Ledck.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "XCE100串口", equipconfig.Xce100ck.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "测试标准", equipconfig.TestStandard, startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("配置参数", "LED型号", equipconfig.Ledxh.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "LED串口配置字", equipconfig.LedComstring.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "XCE100串口配置字", equipconfig.Xce100Comstring.ToString(), startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重仪", equipconfig.ZzyEnable?"Y":"N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重仪型号", equipconfig.ZzyXh, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重仪串口", equipconfig.ZzyCk, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重仪串口配置", equipconfig.ZzyCkpzz, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重确认方式", equipconfig.ZzSureStyle.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重光电通道", equipconfig.ZzGdChanel.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重左通道", equipconfig.LeftZzChanel.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "轴重右通道", equipconfig.RightZzChanel.ToString(), startUpPath + "/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("轴重仪", "使用称重WCF", equipconfig.useWeightWCF ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("轴重仪", "称重WCF地址", equipconfig.WeightWCFaddress, startUpPath + "/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("配置参数", "测功机", equipconfig.Cgjifpz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "废气仪", equipconfig.Fqyifpz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "流量计", equipconfig.Lljifpz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "油耗仪", equipconfig.isYhyPz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "烟度计", equipconfig.Ydjifpz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "滤纸烟度计", equipconfig.Lzydjifpz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "滤纸烟度计地址", equipconfig.lzydjadd, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "柴油车NOx", equipconfig.NOxifpz.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "LED屏", equipconfig.Ledifpz.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("吸收功率", "功率", equipconfig.PowerSet[0] + "," + equipconfig.PowerSet[1] + "," + equipconfig.PowerSet[2] + "," + equipconfig.PowerSet[3] + "," +
                equipconfig.PowerSet[4] + "," + equipconfig.PowerSet[5] + "," + equipconfig.PowerSet[6] + "," + equipconfig.PowerSet[7] + "," + equipconfig.PowerSet[8] + "," + equipconfig.PowerSet[9] + "," + equipconfig.PowerSet[10], startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "温湿度计", equipconfig.TempInstrument.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "统配温湿度计", equipconfig.isTpTempInstrument?"Y":"N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "变频器控制方式", equipconfig.BpqMethod.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "变频器串口配置", equipconfig.BpqCom + "/" + equipconfig.BpqComPz + "/" + equipconfig.BpqXh.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "变频器电源", equipconfig.BpqDy.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "散热风扇", equipconfig.HeatFan.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "紧急停止", equipconfig.EmergencyStop.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "显示方式", equipconfig.DisplayMethod.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "司机助", equipconfig.DriverDisplay.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "司机助分辨率", equipconfig.DriverFbl.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "废气仪响应时间", equipconfig.FqyDelayTime.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "流量计响应时间", equipconfig.LljDelayTime.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "流量计流量名义值", equipconfig.Lljllmy.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "加载减速稳定时间", equipconfig.LugdownWdsj.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "全自动工作模式", equipconfig.WorkAutomaticMode?"Y":"N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "到位光电", equipconfig.CarGdChanel.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "是否包含光电遥控", equipconfig.isIgbtContainGdyk?"Y":"N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "LEDROW1", equipconfig.ledrow1.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "LEDROW2", equipconfig.ledrow2.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "LEDTJPH", equipconfig.LEDTJPH.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "显示评价结果", equipconfig.displayJudge ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "使用金华监控选项", equipconfig.useJHJK ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "金华屏蔽显示", equipconfig.useJHSCREEN ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "金华轮边功率预警值", equipconfig.JHLBGLB.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "金华过量空气系数最小值", equipconfig.JHLAMBDAMIN.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "金华过量空气系数最大值", equipconfig.JHLAMBDAMAX.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "过程数据", equipconfig.DATASECONDS_TYPE, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "驰达废气仪", equipconfig.cd_fqy ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "驰达烟度计", equipconfig.cd_ydj ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "南华司机助", equipconfig.IsUseNhSjz ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "南华司机助串口", equipconfig.NhSjz_Com, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "南华司机助串口配置", equipconfig.NhSjz_ComString, startUpPath + "/detectConfig.ini");
                
                return true;
            }
            catch
            {
                return false;
            }
        }
        public VmasConfigInfdata getVmasConfigIni()
        {
            float a = 0;
            int b = 0;
            VmasConfigInfdata configinidata = new VmasConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("配置参数", "test", "", temp, 2048, @"D:\exhaustTest\detect.ini");
            if (temp.ToString().Trim() == "1")
                configinidata.Test = true;
            else
                configinidata.Test = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "速度监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.SpeedMonitor = true;
            //else
            //    configinidata.SpeedMonitor = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "加载功率监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.PowerMonitor = true;
            else
                configinidata.PowerMonitor = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "浓度监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.ConcentrationMonitor = true;
            //else
            //    configinidata.ConcentrationMonitor = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "流量监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.FlowMonitorr = true;
            //else
            //    configinidata.FlowMonitorr = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "稀释比监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.ThinnerratioMonitor = true;
            else
                configinidata.ThinnerratioMonitor = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "环境氧监测", "true", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.Huanjingo2Monitor = true;
            //else
            //    configinidata.Huanjingo2Monitor = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "残余量监测", "true", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.RemainedMonitor = true;
            else
                configinidata.RemainedMonitor = false;


            ini.INIIO.GetPrivateProfileString("VMAS", "是否调零", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfFqyTl = true;
            else
                configinidata.IfFqyTl = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "是否反吹", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Flowback = true;
            else
                configinidata.Flowback = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "是否确认温湿度", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfSureTemp = true;
            else
                configinidata.IfSureTemp = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "是否显示过程数据", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfDisplayData = true;
            else
                configinidata.IfDisplayData = false;

            ini.INIIO.GetPrivateProfileString("VMAS", "是否全过程监控流量", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsWholeProcessJK = true;
            else
                configinidata.IsWholeProcessJK = false;

            ini.INIIO.GetPrivateProfileString("VMAS", "自动开始", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.AutoRestart = true;
            else
                configinidata.AutoRestart = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "浓度值", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (float.TryParse(temp.ToString().Trim(), out a))
            //    configinidata.Ndz = a;
            //else
                configinidata.Ndz = 6f;
            ini.INIIO.GetPrivateProfileString("VMAS", "流量计流量值", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Lljll = a;
            else
                configinidata.Lljll = 3f;
            ini.INIIO.GetPrivateProfileString("VMAS", "尾气流量值", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Wqll = a;
            else
                configinidata.Wqll = 3f;
            ini.INIIO.GetPrivateProfileString("VMAS", "稀释比", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Xsb = a;
            else
                configinidata.Xsb = 3f;
            ini.INIIO.GetPrivateProfileString("VMAS", "功率加载", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Gljz = a;
            else
                configinidata.Gljz = 3f;

            ini.INIIO.GetPrivateProfileString("VMAS", "连续超差", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Lxcc = a;
            else
                configinidata.Lxcc = 3f;
            ini.INIIO.GetPrivateProfileString("VMAS", "累计超差", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Ljcc = a;
            else
                configinidata.Ljcc = 3f;
            ini.INIIO.GetPrivateProfileString("VMAS", "怠速时间", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.Dssj = b;
            else
                configinidata.Dssj = 40;
            ini.INIIO.GetPrivateProfileString("VMAS", "反吹时间", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.FlowTime = b;
            else
                configinidata.FlowTime = 30;
            ini.INIIO.GetPrivateProfileString("VMAS", "浓度超差时间", "3", temp, 2048, startUpPath + "/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.ndccsj = b;
            else
                configinidata.ndccsj = 3;
            ini.INIIO.GetPrivateProfileString("VMAS", "超差时间系数", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.CcTimeXs = a;
            else
                configinidata.CcTimeXs = 0.6f;
            ini.INIIO.GetPrivateProfileString("VMAS", "是否检测油温", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsTestYw = true;
            else
                configinidata.IsTestYw = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "山东浓度监控", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.SdCo2AndO2Monitor = true;
            else
                configinidata.SdCo2AndO2Monitor = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "在调零前初检", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.CjBeforeTl = true;
            else
                configinidata.CjBeforeTl = false;

            ini.INIIO.GetPrivateProfileString("VMAS", "不重复调零", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.vmasNoReZero = true;
            else
                configinidata.vmasNoReZero = false;
            ini.INIIO.GetPrivateProfileString("VMAS", "加载力比例", "1.0", temp, 2048, startUpPath + "/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
            {
                if (a > 0 && a < 1)
                    configinidata.vmasPowerXs = a;
                else
                    configinidata.vmasPowerXs = 1f;
            }
            else
                configinidata.vmasPowerXs = 1.0f;
            return configinidata;
        }

        public bool writeVmasConfigIni(VmasConfigInfdata configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("VMAS", "速度监测", configinidata.SpeedMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "加载功率监测", configinidata.PowerMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "浓度监测", configinidata.ConcentrationMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "流量监测", configinidata.FlowMonitorr.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "稀释比监测", configinidata.ThinnerratioMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "环境氧监测", configinidata.Huanjingo2Monitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "残余量监测", configinidata.RemainedMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "是否全过程监控流量", configinidata.IsWholeProcessJK.ToString().ToLower(), startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("VMAS", "是否反吹", configinidata.Flowback.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "是否调零", configinidata.IfFqyTl.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "是否确认温湿度", configinidata.IfSureTemp.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "是否显示过程数据", configinidata.IfDisplayData.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "自动开始", configinidata.AutoRestart.ToString().ToLower(), startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("VMAS", "浓度值", configinidata.Ndz.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "流量计流量值", configinidata.Lljll.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "尾气流量值", configinidata.Wqll.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "稀释比", configinidata.Xsb.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "功率加载", configinidata.Gljz.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "连续超差", configinidata.Lxcc.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "累计超差", configinidata.Ljcc.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "怠速时间", configinidata.Dssj.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "反吹时间", configinidata.FlowTime.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "浓度超差时间", configinidata.ndccsj.ToString("0"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "是否检测油温", configinidata.IsTestYw.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "山东浓度监控", configinidata.SdCo2AndO2Monitor.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "在调零前初检", configinidata.CjBeforeTl.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "不重复调零", configinidata.vmasNoReZero.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("VMAS", "加载力比例", configinidata.vmasPowerXs.ToString("0.0"), startUpPath + "/detectConfig.ini");

                return true;
            }
            catch
            {
                return false;
            }
        }
        public AsmConfigInfdata getAsmConfigIni()
        {
            float a = 0;
            int b = 0;
            AsmConfigInfdata configinidata = new AsmConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("ASM", "速度监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
           // if (temp.ToString().Trim() == "true")
                configinidata.SpeedMonitor = true;
            //else
            //    configinidata.SpeedMonitor = false;
            ini.INIIO.GetPrivateProfileString("ASM", "速度05监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Speed05Monitor = true;
            else
                configinidata.Speed05Monitor = false;
            ini.INIIO.GetPrivateProfileString("ASM", "加载功率监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.PowerMonitor = true;
            else
                configinidata.PowerMonitor = false;
            ini.INIIO.GetPrivateProfileString("ASM", "浓度监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.ConcentrationMonitor = true;
            //else
            //    configinidata.ConcentrationMonitor = false;

            ini.INIIO.GetPrivateProfileString("ASM", "残余量监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
           // if (temp.ToString().Trim() == "true")
                configinidata.RemainedMonitor = true;
            //else
            //    configinidata.RemainedMonitor = false;


            ini.INIIO.GetPrivateProfileString("ASM", "是否调零", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfFqyTl = true;
            else
                configinidata.IfFqyTl = false;
            ini.INIIO.GetPrivateProfileString("ASM", "是否反吹", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Flowback = true;
            else
                configinidata.Flowback = false;
            ini.INIIO.GetPrivateProfileString("ASM", "是否确认温湿度", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfSureTemp = true;
            else
                configinidata.IfSureTemp = false;
            ini.INIIO.GetPrivateProfileString("ASM", "是否显示过程数据", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfDisplayData = true;
            else
                configinidata.IfDisplayData = false;

            ini.INIIO.GetPrivateProfileString("ASM", "浓度值", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (float.TryParse(temp.ToString().Trim(), out a))
              //  configinidata.Ndz = a;
            //else
                configinidata.Ndz = 6f;

            ini.INIIO.GetPrivateProfileString("ASM", "功率加载", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Gljz = a;
            else
                configinidata.Gljz = 3f;
            ini.INIIO.GetPrivateProfileString("ASM", "功率参数", "1.0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Glcs = a;
            else
                configinidata.Glcs = 1f;

            ini.INIIO.GetPrivateProfileString("ASM", "连续超差", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Lxcc = a;
            else
                configinidata.Lxcc = 3f;

            ini.INIIO.GetPrivateProfileString("ASM", "反吹时间", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.FlowTime = b;
            else
                configinidata.FlowTime = 30;
            ini.INIIO.GetPrivateProfileString("ASM", "是否检测油温", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsTestYw = true;
            else
                configinidata.IsTestYw = false;
            ini.INIIO.GetPrivateProfileString("ASM", "是否快速工况通过", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsKsgkUsed = true;
            else
                configinidata.IsKsgkUsed = false;
            ini.INIIO.GetPrivateProfileString("ASM", "是否修正CO2", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsFixCo2 = true;
            else
                configinidata.IsFixCo2 = false;
            ini.INIIO.GetPrivateProfileString("ASM", "快速工况一半限值要求", "true", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsAsmHalfXzKsgk = true;
            else
                configinidata.IsAsmHalfXzKsgk = false;

            ini.INIIO.GetPrivateProfileString("ASM", "油温计", "废气仪", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.Ywj = temp.ToString();


            ini.INIIO.GetPrivateProfileString("ASM", "不重复调零", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.asmNoReZero = true;
            else
                configinidata.asmNoReZero = false;
            return configinidata;
        }

        public bool writeAsmConfigIni(AsmConfigInfdata configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("ASM", "速度监测", configinidata.SpeedMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "速度05监测", configinidata.Speed05Monitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "加载功率监测", configinidata.PowerMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "浓度监测", configinidata.ConcentrationMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "残余量监测", configinidata.RemainedMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("ASM", "是否反吹", configinidata.Flowback.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "是否调零", configinidata.IfFqyTl.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "是否确认温湿度", configinidata.IfSureTemp.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "是否显示过程数据", configinidata.IfDisplayData.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "是否检测油温", configinidata.IsTestYw.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "是否快速工况通过", configinidata.IsKsgkUsed.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "快速工况一半限值要求", configinidata.IsAsmHalfXzKsgk.ToString().ToLower(), startUpPath + "/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("ASM", "浓度值", configinidata.Ndz.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "功率加载", configinidata.Gljz.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "连续超差", configinidata.Lxcc.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "反吹时间", configinidata.FlowTime.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "油温计", configinidata.Ywj, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("ASM", "不重复调零", configinidata.asmNoReZero.ToString().ToLower(), startUpPath + "/detectConfig.ini");

                return true;
            }
            catch
            {
                return false;
            }
        }

        public SdsConfigInfdata getSdsConfigIni()
        {
            float a = 0;
            int b = 0;
            SdsConfigInfdata configinidata = new SdsConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("SDS", "转速监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.RotateSpeedMonitor = true;
            else
                configinidata.RotateSpeedMonitor = false;
            ini.INIIO.GetPrivateProfileString("SDS", "浓度监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.ConcentrationMonitor = true;
           // else
           //     configinidata.ConcentrationMonitor = false;

            ini.INIIO.GetPrivateProfileString("SDS", "是否调零", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfFqyTl = true;
            else
                configinidata.IfFqyTl = false;
            ini.INIIO.GetPrivateProfileString("SDS", "是否反吹", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.Flowback = true;
            else
                configinidata.Flowback = false;

            ini.INIIO.GetPrivateProfileString("SDS", "浓度值", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (float.TryParse(temp.ToString().Trim(), out a))
              //  configinidata.Ndz = a;
            //else
                configinidata.Ndz = 6f;

            ini.INIIO.GetPrivateProfileString("SDS", "转速超差", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.Zscc = b;
            else
                configinidata.Zscc = 100;

            ini.INIIO.GetPrivateProfileString("SDS", "反吹时间", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.FlowTime = b;
            else
                configinidata.FlowTime = 30;

            ini.INIIO.GetPrivateProfileString("SDS", "转速计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsj = temp.ToString();

            ini.INIIO.GetPrivateProfileString("SDS", "转速计串口", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsjck = temp.ToString();

            ini.INIIO.GetPrivateProfileString("SDS", "油温计", "废气仪", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.Ywj = temp.ToString();
            ini.INIIO.GetPrivateProfileString("SDS", "是否检测油温", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsTestYw = true;
            else
                configinidata.IsTestYw = false;
            ini.INIIO.GetPrivateProfileString("SDS", "是否确认温湿度", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsSureTemp = true;
            else
                configinidata.IsSureTemp = false;

            ini.INIIO.GetPrivateProfileString("SDS", "预热计时模式", "0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.TimerMode3500 = b;
            else
                configinidata.TimerMode3500 = 30;
            ini.INIIO.GetPrivateProfileString("SDS", "高怠速准备计时模式", "0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.TimerModeHP = b;
            else
                configinidata.TimerModeHP = 30;
            ini.INIIO.GetPrivateProfileString("SDS", "高怠速测量计时模式", "0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.TimerModeHT = b;
            else
                configinidata.TimerModeHT = 30;
            ini.INIIO.GetPrivateProfileString("SDS", "怠速准备计时模式", "0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.TimerModeLP = b;
            else
                configinidata.TimerModeLP = 30;
            ini.INIIO.GetPrivateProfileString("SDS", "怠速测量计时模式", "0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.TimerModeLT = b;
            else
                configinidata.TimerModeLT = 30;

            ini.INIIO.GetPrivateProfileString("SDS", "不重复调零", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.sdsNoReZero = true;
            else
                configinidata.sdsNoReZero = false;
            ini.INIIO.GetPrivateProfileString("SDS", "sdsHighLambdaMonitor", "true", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.sdsHighLambdaMonitor = true;
            else
                configinidata.sdsHighLambdaMonitor = false;
            ini.INIIO.GetPrivateProfileString("SDS", "sdsLowLambdaMonitor", "true", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.sdsLowLambdaMonitor = true;
            else
                configinidata.sdsLowLambdaMonitor = false;
            return configinidata;
        }

        public bool writeSdsConfigIni(SdsConfigInfdata configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("SDS", "转速监测", configinidata.RotateSpeedMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "浓度监测", configinidata.ConcentrationMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("SDS", "是否反吹", configinidata.Flowback.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "是否调零", configinidata.IfFqyTl.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "是否检测油温", configinidata.IsTestYw.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "是否确认温湿度", configinidata.IsSureTemp.ToString().ToLower(), startUpPath + "/detectConfig.ini");

                ini.INIIO.WritePrivateProfileString("SDS", "浓度值", configinidata.Ndz.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "转速超差", configinidata.Zscc.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "反吹时间", configinidata.FlowTime.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "转速计", configinidata.Zsj, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "转速计串口", configinidata.Zsjck, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "油温计", configinidata.Ywj, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "预热计时模式", configinidata.TimerMode3500.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "高怠速准备计时模式", configinidata.TimerModeHP.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "高怠速测量计时模式", configinidata.TimerModeHT.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "怠速准备计时模式", configinidata.TimerModeLP.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "怠速测量计时模式", configinidata.TimerModeLT.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "不重复调零", configinidata.sdsNoReZero.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "sdsHighLambdaMonitor", configinidata.sdsHighLambdaMonitor.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("SDS", "sdsLowLambdaMonitor", configinidata.sdsLowLambdaMonitor.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
        public BtgConfigInfdata getBtgConfigIni()
        {
            double a = 0;
            int b = 0;
            BtgConfigInfdata configinidata = new BtgConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("BTG", "转速监测", "", temp, 2048, startUpPath+"/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.RotateSpeedMonitor = true;
            //else
            //    configinidata.RotateSpeedMonitor = false;
            ini.INIIO.GetPrivateProfileString("BTG", "金华过程转速监测", "", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.jhzsgcjk = true;
            else
                configinidata.jhzsgcjk = false;


            ini.INIIO.GetPrivateProfileString("BTG", "断油转速", "2500", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.Dyzs = b;
            else
                configinidata.Dyzs = 2500;

            ini.INIIO.GetPrivateProfileString("BTG", "转速计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsj = temp.ToString();

            ini.INIIO.GetPrivateProfileString("BTG", "转速计串口", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsjck = temp.ToString();

            ini.INIIO.GetPrivateProfileString("BTG", "油温计", "烟度计", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.Ywj = temp.ToString();

            ini.INIIO.GetPrivateProfileString("BTG", "是否检测油温", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsTestYw = true;
            else
                configinidata.IsTestYw = false;
            ini.INIIO.GetPrivateProfileString("BTG", "人工确认探头", "N", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.BtgManualTantou = true;
            else
                configinidata.BtgManualTantou = false;
            ini.INIIO.GetPrivateProfileString("BTG", "不透光吹拂次数", "0", temp, 2048,  startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.Btgcfcs = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.Btgcfcs = 0;
            }
            ini.INIIO.GetPrivateProfileString("BTG", "不透光测量次数", "4", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.btgclcs = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.btgclcs = 4;
            }
            ini.INIIO.GetPrivateProfileString("BTG", "怠速转速取值点", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.btgDszsValue = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.btgDszsValue = 0;
            }
            ini.INIIO.GetPrivateProfileString("BTG", "烟度监控", "Y", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isYdjk = true;
            else
                configinidata.isYdjk = false;
            ini.INIIO.GetPrivateProfileString("BTG", "烟度监控值", "0.02", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ydjk_value = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ydjk_value = 0.02;
            }
            return configinidata;
        }
        public bool writeBtgConfigIni(BtgConfigInfdata configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("BTG", "转速监测", configinidata.RotateSpeedMonitor.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "金华过程转速监测", configinidata.jhzsgcjk.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "断油转速", configinidata.Dyzs.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "转速计", configinidata.Zsj, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "转速计串口", configinidata.Zsjck, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "油温计", configinidata.Ywj, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "是否检测油温", configinidata.IsTestYw.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "人工确认探头", configinidata.BtgManualTantou ? "Y" : "N", startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "不透光吹拂次数", configinidata.Btgcfcs.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "不透光测量次数", configinidata.btgclcs.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "怠速转速取值点", configinidata.btgDszsValue.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "烟度监控", configinidata.isYdjk ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("BTG", "烟度监控值", configinidata.ydjk_value.ToString("0.00"), startUpPath + "/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
        public DynConfigInfdata getDynConfigIni()
        {
            float a = 0;
            int b = 0;
            DynConfigInfdata configinidata = new DynConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            

            ini.INIIO.GetPrivateProfileString("DYN", "转速计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsj = temp.ToString();

            ini.INIIO.GetPrivateProfileString("DYN", "转速计串口", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsjck = temp.ToString();
            ini.INIIO.GetPrivateProfileString("DYN", "超差转速", "200", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.cczs = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.cczs = 200;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "转速稳定时间", "3", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.stableTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.stableTime = 3;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "加载力时间", "1000", temp, 2048, startUpPath+"/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.forceTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.forceTime =1000;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "油耗加载力时间", "1000", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.FuelforceTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.FuelforceTime = 1000;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "油耗速度区间", "0.5", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.FuelSdQj = float.Parse(temp.ToString());
            }
            catch
            {
                configinidata.FuelSdQj = 0.5f;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "动力性速度区间", "0.5", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynSdqj = float.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynSdqj = 0.5f;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "动力性稳定速度区间", "0.5", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynVwSdqj = float.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynVwSdqj = 0.5f;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "油耗加载力区间", "20", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.FuelForceQj = float.Parse(temp.ToString());
            }
            catch
            {
                configinidata.FuelForceQj = 20;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "动力加载力区间", "20", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynForceQj = float.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynForceQj = 20;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "动力性最长稳定时间", "15", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynMaxWaitTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynMaxWaitTime = 15;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "遥控类型", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynYkStyle = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynYkStyle = 0;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "遥控通道", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynWjyktd = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynWjyktd = 1;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "遥控按键值", "1", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynYkKey = temp.ToString();

            ini.INIIO.GetPrivateProfileString("DYN", "重新开始类型", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynReStartStyle = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynReStartStyle = 0;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "使用光电判断到位", "N", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynUseGddw = (temp.ToString()=="Y");
            ini.INIIO.GetPrivateProfileString("DYN", "光电到位时间", "5", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynGddwTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynGddwTime = 5;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "监控实时油耗", "N", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynFuelJk = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "实时油耗限值", "0.5", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynFuelXz = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynFuelXz = 0.5;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "使用遥控判断到位", "N", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynUseYkdw = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "油耗复检次数", "2", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.FuelTestFjjs = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.FuelTestFjjs = 2;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "文件格式", "0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynFileStyle = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynFileStyle = 0;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "长时间加载不稳定停止检测", "N", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynStopUnstable = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "不稳定时间限值", "15", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynUnstableTime = int.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynUnstableTime = 15;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "动力性速度系数", "1.0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynSdxs = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynSdxs = 1.0;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "动力性加载力系数", "1.0", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.DynNlxs = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.DynNlxs = 1.0;
            }
            ini.INIIO.GetPrivateProfileString("DYN", "调零", "Y", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynTl = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "背景测定", "Y", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynBackTest = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "CO2测定", "Y", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynCO2Test = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "反吹", "Y", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynFlowBack = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "动力性遥控确认", "Y", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynYkqr = (temp.ToString() == "Y");
            ini.INIIO.GetPrivateProfileString("DYN", "使用人工确认按钮", "Y", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            configinidata.DynUseManualKey = (temp.ToString() == "Y");

            return configinidata;
        }

        public bool writeDynConfigIni(DynConfigInfdata configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("DYN", "转速计", configinidata.Zsj, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "转速计串口", configinidata.Zsjck, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "超差转速", configinidata.cczs.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "转速稳定时间", configinidata.stableTime.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "加载力时间", configinidata.forceTime.ToString(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "油耗加载力时间", configinidata.FuelforceTime.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "油耗速度区间", configinidata.FuelSdQj.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "油耗加载力区间", configinidata.FuelForceQj.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "动力性速度区间", configinidata.DynSdqj.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "动力性稳定速度区间", configinidata.DynVwSdqj.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "动力加载力区间", configinidata.DynForceQj.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "动力性最长稳定时间", configinidata.DynMaxWaitTime.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "遥控类型", configinidata.DynYkStyle.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "遥控通道", configinidata.DynWjyktd.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "遥控按键值", configinidata.DynYkKey, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "重新开始类型", configinidata.DynReStartStyle.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "使用光电判断到位", configinidata.DynUseGddw?"Y":"N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "光电到位时间", configinidata.DynGddwTime.ToString("0"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "监控实时油耗", configinidata.DynFuelJk ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "实时油耗限值", configinidata.DynFuelXz.ToString("0.00"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "使用遥控判断到位", configinidata.DynUseYkdw ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "油耗复检次数", configinidata.FuelTestFjjs.ToString("0"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "文件格式", configinidata.DynFileStyle.ToString("0"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "长时间加载不稳定停止检测", configinidata.DynStopUnstable ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "不稳定时间限值", configinidata.DynUnstableTime.ToString("0"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "调零", configinidata.DynTl ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "背景测定", configinidata.DynBackTest ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "CO2测定", configinidata.DynCO2Test ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "反吹", configinidata.DynFlowBack ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "动力性遥控确认", configinidata.DynYkqr ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "使用人工确认按钮", configinidata.DynUseManualKey ? "Y" : "N", startUpPath + "/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
        public bool writeDynXsIni(double dynsdxs,double dynnlxs)
        {
            try
            {
                ini.INIIO.WritePrivateProfileString("DYN", "动力性速度系数", dynsdxs.ToString("0.00"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("DYN", "动力性加载力系数", dynnlxs.ToString("0.00"), startUpPath + "/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
        public LugdownConfigInfdata getLugdownConfigIni()
        {
            float a = 0;
            int b = 0;
            LugdownConfigInfdata configinidata = new LugdownConfigInfdata();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "扫描最低速度", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.MinSpeed = b;
            else
                configinidata.MinSpeed = 50;

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "是否确认温湿度", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IfSureTemp = true;
            else
                configinidata.IfSureTemp = false;

            
            ini.INIIO.GetPrivateProfileString("配置参数", "是否评价发动机转速", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.isFdjzsJudge = true;
            else
                configinidata.isFdjzsJudge = false;

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "扫描最高速度", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.MaxSpeed = b;
            else
                configinidata.MaxSpeed = 100;

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "转速计", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsj = temp.ToString();

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "转速计串口", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Zsjck = temp.ToString();


            ini.INIIO.GetPrivateProfileString("LUGDOWN", "油温计", "烟度计", temp, 2048, startUpPath + "/detectConfig.ini");
            configinidata.Ywj = temp.ToString();

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "功率扫描模式", "", temp, 2048, startUpPath+"/detectConfig.ini");
            configinidata.Glsmms = temp.ToString();

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "扫描频率", "", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Smpl = a;
            else
                configinidata.Smpl = 100f;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "速度稳定区间", "2", temp, 2048, startUpPath+"/detectConfig.ini");
            if (float.TryParse(temp.ToString().Trim(), out a))
                configinidata.Sdwdqj = a;
            else
                configinidata.Sdwdqj = 2f;

            ini.INIIO.GetPrivateProfileString("LUGDOWN", "是否检测油温", "false", temp, 2048, startUpPath+"/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.IsTestYw = true;
            else
                configinidata.IsTestYw = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "轮边功率取值方式", "0", temp, 2048, startUpPath + "/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.LugdownMaxHpStyle = b;
            else
                configinidata.LugdownMaxHpStyle = 0;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "gsMaxPPD", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.gsMaxPPD = true;
            else
                configinidata.gsMaxPPD = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "gsKcbPD", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.gsKcbPD = true;
            else
                configinidata.gsKcbPD = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "gsKhgPD", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.gsKhgPD = true;
            else
                configinidata.gsKhgPD = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "testNOx", "false", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "true")
                configinidata.testNOx = true;
            else
                configinidata.testNOx = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "测试过程功率监控", "true", temp, 2048, startUpPath + "/detectConfig.ini");
            //if (temp.ToString().Trim() == "true")
                configinidata.LugdownGljk = true;
            //else
            //    configinidata.LugdownGljk = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "功率监控规定值", "20", temp, 2048, startUpPath + "/detectConfig.ini");
            if (int.TryParse(temp.ToString().Trim(), out b))
                configinidata.Lugdown_Gljk_value = b;
            else
                configinidata.Lugdown_Gljk_value = 20;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "功率扫描阶段烟度监控", "N", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isYdjk_glsm = true;
            else
                configinidata.isYdjk_glsm = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "功率扫描阶段烟度监控值", "0.02", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ydjk_glsm_value = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ydjk_glsm_value = 0.02;
            }
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "测量阶段烟度监控", "Y", temp, 2048, startUpPath + "/detectConfig.ini");
            if (temp.ToString().Trim() == "Y")
                configinidata.isYdjk_cl = true;
            else
                configinidata.isYdjk_cl = false;
            ini.INIIO.GetPrivateProfileString("LUGDOWN", "测量阶段烟度监控值", "0.02", temp, 2048, startUpPath + "/detectConfig.ini");          //读配置文件（段名，字段，默认值，保存的strbuilder，大小，路径）
            try
            {
                configinidata.ydjk_cl_value = double.Parse(temp.ToString());
            }
            catch
            {
                configinidata.ydjk_cl_value = 0.02;
            }
            return configinidata;
        }

        public bool writeLugdownConfigIni(LugdownConfigInfdata configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "扫描最低速度", configinidata.MinSpeed.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "扫描最高速度", configinidata.MaxSpeed.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "是否确认温湿度", configinidata.IfSureTemp.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("配置参数", "是否评价发动机转速", configinidata.isFdjzsJudge.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "转速计", configinidata.Zsj, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "转速计串口", configinidata.Zsjck, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "油温计", configinidata.Ywj, startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "功率扫描模式", configinidata.Glsmms, startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "扫描频率", configinidata.Smpl.ToString("0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "速度稳定区间", configinidata.Sdwdqj.ToString("0.0"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "是否检测油温", configinidata.IsTestYw.ToString().ToLower(), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "轮边功率取值方式", configinidata.LugdownMaxHpStyle.ToString(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "gsMaxPPD", configinidata.gsMaxPPD.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "gsKcbPD", configinidata.gsKcbPD.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "gsKhgPD", configinidata.gsKhgPD.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "testNOx", configinidata.testNOx.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "测试过程功率监控", configinidata.LugdownGljk.ToString().ToLower(), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "功率监控规定值", configinidata.Lugdown_Gljk_value.ToString("0"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "功率扫描阶段烟度监控", configinidata.isYdjk_glsm ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "功率扫描阶段烟度监控值", configinidata.ydjk_glsm_value.ToString("0.00"), startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "测量阶段烟度监控", configinidata.isYdjk_cl ? "Y" : "N", startUpPath + "/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("LUGDOWN", "测量阶段烟度监控值", configinidata.ydjk_cl_value.ToString("0.00"), startUpPath + "/detectConfig.ini");
                return true;
            }

            catch
            {
                return false;
            }
        }
        public thaxs getthaxsConfigIni()
        {
            double a = 0;
            thaxs configinidata = new thaxs();
            StringBuilder temp = new StringBuilder();
            temp.Length = 2048;
            ini.INIIO.GetPrivateProfileString("THA", "TEMP", "1.0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (double.TryParse(temp.ToString().Trim(), out a))
                configinidata.Tempxs = a;
            else
                configinidata.Tempxs = 1;

            ini.INIIO.GetPrivateProfileString("THA", "HUMI", "1.0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (double.TryParse(temp.ToString().Trim(), out a))
                configinidata.Humixs = a;
            else
                configinidata.Humixs = 1;

            ini.INIIO.GetPrivateProfileString("THA", "AIRP", "1.0", temp, 2048, startUpPath+"/detectConfig.ini");
            if (double.TryParse(temp.ToString().Trim(), out a))
                configinidata.Airpxs = a;
            else
                configinidata.Airpxs = 1;

            return configinidata;
        }
        public bool writeThaxsConfigIni(thaxs configinidata)
        {
            try
            {
                //configInfdata preConfigData = getConfigIni();
                ini.INIIO.WritePrivateProfileString("THA", "TEMP", configinidata.Tempxs.ToString("0.000"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("THA", "HUMI", configinidata.Humixs.ToString("0.000"), startUpPath+"/detectConfig.ini");
                ini.INIIO.WritePrivateProfileString("THA", "AIRP", configinidata.Airpxs.ToString("0.000"), startUpPath+"/detectConfig.ini");
                return true;
            }
            catch
            {
                return false;
            }
        }
    }
}
